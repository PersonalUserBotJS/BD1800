-- 10. 

    SELECT A.NOMBRE_USUARIO, 
           B.NOMBRE_PAIS, 
           COUNT(C.CODIGO_PUBLICACION)
    FROM TBL_USUARIOS A
    INNER JOIN   TBL_PAISES B
    ON (A.CODIGO_PAIS = B.CODIGO_PAIS)
    LEFT JOIN TBL_PUBLICACIONES C   --SE USA EL LEFT JOIN PARA MOSTRAR A TODOS LOS USUARIOS QUE TENGAN O NO PUBLICACIONES
    ON (A.CODIGO_USUARIO = C.CODIGO_USUARIO)
    GROUP BY A.NOMBRE_USUARIO,
             B.NOMBRE_PAIS
    ORDER BY 3 DESC;

    -- A LA SIGUIENTE SUBCONSULTA SE LE ASIGNA EL ALIAS DE "PUBLICACIONES_USUARIOS"
    WITH PUBLICACIONES_USUARIOS AS (
        SELECT CODIGO_USUARIO, COUNT(1) CANTIDAD_PUBLICACIONES
        FROM TBL_PUBLICACIONES
        GROUP BY CODIGO_USUARIO;
    ),
    AMIGOS_USUARIOS AS (
        SELECT CODIGO_USUARIO, COUNT(1) CANTIDAD_AMIGOS
        FROM TBL_AMIGOS;
        WHERE CODIGO_ESTATUS = 1
        GROUP BY CODIGO_USUARIO;
    ),
    LIKES_PUBLICACIONES AS(
        SELECT CODIGO_USUARIO, COUNT(1) LIKES_PUBLICACIONES 
        FROM TBL_LIKES_PUBLICACIONES
        GROUP BY CODIGO_USUARIO
    ),
    LIKES_FOTOGRAFIAS AS(
        SELECT CODIGO_USUARIO, COUNT(1) LIKES_FOROGRAFIAS 
        FROM TBL_LIKES_FOTOGRAFIAS
        GROUP BY CODIGO_USUARIO
    ),
    ETIQUETAS AS(
        SELECT CODIGO_USUARIO, COUNT(1) CANTIDAD_ETIQUETAS
        FROM TBL_ETIQUETAS_FOTOGRAFIAS
        GROUP BY CODIGO_USUARIO
    )
    SELECT A.NOMBRE_USUARIO, 
           B.NOMBRE_PAIS,
           NVL(C.CANTIDAD_PUBLICACIONES, 0) AS CANTIDAD_PUBLICACIONES, -- INVESTIGAR LA FUNCION NVL
           NVL(D.CANTIDAD_AMIGOS, 0) AS CANTIDAD_AMIGOS,
           NVL(E.LIKES_PUBLICACIONES, 0) + NVL(F.LIKES_FOTOGRAFIAS, 0) AS CANTIDAD_LIKES
    FROM TBL_USUARIOS A
    INNER JOIN   TBL_PAISES B
    ON (A.CODIGO_PAIS = B.CODIGO_PAIS)
    LEFT JOIN PUBLICACIONES_USUARIOS C
    ON (A.CODIGO_USUASRIO = C.CODIGO_USUARIO)
    LEFT JOIN AMIGOS_USUARIOS D
    ON (A.CODIGO_USUARIO = D.CODIGO_USUARIO)
    LEFT JOIN LIKES_PUBLICACIONES E
    ON (A.CODIGO_USUARIO = E.CODIGO_USUARIO)
    LEFT JOIN LIKES_FOTOGRAFIAS F
    ON (A.CODIGO_USUARIO = F.CODIGO_USUARIO)
    LEFT JOIN ETIQUETAS G
    ON (A.CODIGO_USUARIO = G.CODIGO_USUARIO)
    ORDER BY 1 DESC;

