---6. Un usuario puede estar suscritos a tableros, listas y tarjetas, de tal 
--- forma que si hay un cambio

SELECT B.CODIGO_USUARIO, B.NOMBRE || ' ' || B.APELLIDO AS NOMBRE, COUNT(CODIGO_LISTA)CANTIDAD_LISTAS, COUNT(CODIGO_TABLERO)CANTIDAD_TABLEROS, COUNT(CODIGO_TARJETA)CANTIDAD_TARJETAS
FROM tbl_suscripciones A
RIGHT JOIN TBL_USUARIOS B
ON (A.CODIGO_USUARIO = B.CODIGO_USUARIO)
GROUP BY B.CODIGO_USUARIO, B.NOMBRE || ' ' || B.APELLIDO;

SELECT * FROM TBL_USUARIOS;

SELECT *
FROM TBL_SUSCRIPCIONES
WHERE CODIGO_USUARIO = 79;

--7.
SELECT NOMBRE_ORGANIZACION, COUNT(B.CODIGO_USUARIO) USUARIOS_REGISTRADOS
FROM TBL_ORGANIZACIONES A
LEFT JOIN TBL_USUARIOS_X_ORGANIZACION B
ON (A.CODIGO_ORGANIZACION = B.CODIGO_ORGANIZACION)
GROUP BY NOMBRE_ORGANIZACION;

WITH TABLEROS AS (
    SELECT CODIGO_ORGANIZACION, COUNT(*) CANTIDAD_TABLEROS
    FROM TBL_TABLERO
    GROUP BY CODIGO_ORGANIZACION
),
USUARIOS_REGISTRADOS AS(
    SELECT CODIGO_ORGANIZACION, COUNT(*)
    FROM TBL_USUARIOS_X_ORGANIZACION
    GROUP BY CODIGO_ORGANIZACION
)
SELECT NOMBRE_ORGANIZACION, NVL(B.CODIGO_USUARIOS, 0) CANTIDAD_USUARIOS,NVL(C.CANTIDAD_TABLEROS, 0)CANTIDAD_TABLERO
     
FROM TBL_ORGANIZACIONES A
LEFT JOIN TBL_USUARIOS_X_ORGANIZACION B
ON (A.CODIGO_ORGANIZACION = B.CODIGO_ORGANIZACION)
LEFT JOIN TABLEROS C
ON(A.CODIGO_ORGANIZACION = B.CODIGO_ORGANIZACION)
GROUP BY A.NOMBRE_ORGANIZACION, C.CANTIDAD_TABLEROS, B.CODIGO_USUARIO;

SELECT B.CODIGO_ORGANIZACION, COUNT(*)
FROM TBL_LISTAS A
INNER JOIN CANTIDAD_LISTAS


SELECT CODIGO_ORGANIZACION, COUNT(*)
FROM TBL_USUARIOS_X_ORGANIZACION
GROUP BY CODIGO_ORGANIZACION;
